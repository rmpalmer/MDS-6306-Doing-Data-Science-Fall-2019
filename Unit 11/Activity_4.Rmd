---
title: "Unit 11 Activity4"
author: "Richard Palmer"
date: "10/30/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Activity Four

## get the data

```{r}
# install.packages("fpp")
library(fpp2)
data(maxtemp)
temps <- window(maxtemp, start = 1990)
orig_df <- data.frame(temps,year=trunc(time(temps)))
```

## Simple Exponential Smoothing

```{r}
alpha <- 0.2

ses_model <- ses(temps, initial = "simple",alpha = alpha,h = 5)
ses_fit   <- fitted(ses_model)
ses_df    <- data.frame(ses_fit,year=trunc(time(ses_fit)))
predict   <- ses_model$mean
pred_df   <- data.frame(predict,year=trunc(time(predict)))
```

## plot original and ses result

```{r}
orig_df %>% mutate(what='Recorded',val=temps) %>%
  bind_rows(ses_df %>% mutate(what='Smoothed',val=ses_fit)) %>%
  bind_rows(pred_df %>% mutate(what='Predicted',val=predict)) %>%
  ggplot(aes(y=val,x=year,color=what)) + 
  geom_line() +
  ggtitle('Recorded, Smoothed, and Predicted Temperatures from SES') +
  xlab('year') +
  ylab('Temp (C)')
```

## Holt's Linear Trend

```{r}
alpha <- 0.8
beta  <- 0.4
holt_model <- holt(temps, alpha = alpha, beta = beta, initial = "optimal", damped=TRUE, h = 5)
holt_fit   <- fitted(holt_model)
holt_df    <- data.frame(holt_fit,year=trunc(time(holt_fit)))
predict   <- holt_model$mean
pred_df   <- data.frame(predict,year=trunc(time(predict)))
```

## Plot original and holt result
```{r}
orig_df %>% mutate(what='Recorded',val=temps) %>%
  bind_rows(holt_df %>% mutate(what='Smoothed',val=holt_fit)) %>%
  bind_rows(pred_df %>% mutate(what='Predicted',val=predict)) %>%
  ggplot(aes(y=val,x=year,color=what)) + 
  geom_line() +
  ggtitle('Recorded, Smoothed, and Predicted Temperatures from Holt') +
  xlab('year') +
  ylab('Temp (C)')
```

