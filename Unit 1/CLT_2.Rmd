---
title: "CLT demo"
author: "Richard M. Palmer"
date: "9/27/2019"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Simulator to Demonstrate CLT

## Control Parameters
```{r}
chisq_pop_size = 10000000 # population size for chi squared distribution
chisq_dof = 2 # degrees of freedom for chi squared distribution
chisq_sam_size = 50 # how big are samples
chisq_nsam = 10000 # how many samples to take
```

## Data Holder
```{r}
xbar_holder3 = numeric(chisq_nsam)  # this will hold the sample means 
chisq_pop = numeric(chisq_pop_size) # This will hold the population with chi sq distrib
```

## Simulate and Store
Generate a single populuation with a chi squared distribution

```{r}
chisq_pop = rchisq(chisq_pop_size, chisq_dof)
expected_mean = mean(chisq_pop)
expected_sam_sd = sd(chisq_pop)/sqrt(chisq_sam_size)
```

## Expected values
Expected mean of samples of size `r chisq_sam_size` is `r expected_mean`

Expected standard deviation of the means of sample size `r chisq_sam_size` is `r expected_sam_sd`

## Display the distribution of sample means 
```{r}
hist(chisq_pop, col="green", main = paste("Distribution of chisquared pop: dof = ",chisq_dof), xlab = "New Population ")
```

## summary statistics for new distribution
```{r}
summary(chisq_pop) # 5 number summary of new population
sd(chisq_pop) # standard deviation of new population
```

## draw samples from population
```{r}
for (i in 1:chisq_nsam)
{
  sample3 = sample(x=chisq_pop, size=chisq_sam_size, replace=TRUE)
  xbar3 = mean(sample3)
  xbar_holder3[i] = xbar3
}
```

## histogram of sample means, drawn from new population

```{r}
hist(xbar_holder3)
```

## statistics of the sample means
```{r}
summary(xbar_holder3)
sd(xbar_holder3)
```