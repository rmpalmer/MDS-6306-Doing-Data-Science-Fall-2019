---
title: "Beachcomber"
author: "Richard M. Palmer"
date: "8/25/2019"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## record the data
```{r}
ages = c(25,19,37,29,40,28,31)
dof = length(ages)-1
```

## key parameters
```{r}
alpha=0.05
null_mean = 21
```

## Identify Null and Alternative hypotheses

H0: The mean age of patrons is `r null_mean`
Ha: The mean age of patrons is not `r null_mean`

## Find the critical value
```{r}
result <- t.test(ages,alternative="two.sided",mu=null_mean,conf.level = 1-alpha)
crit = qt(p=alpha/2,df=dof,lower.tail = FALSE)
```
The critical value is `r crit`

## Draw and shade the distribution
```{r}
curve(dt(x,dof), xlim=c(-5,5),ylim=c(0,0.4), col='red',lwd=2)
d = dt(crit,dof)
abline(h=0)
segments(-1*crit,0,-1*crit,d)
segments(crit,0,crit,d)
```


## Find the test statistic

The test statistic is `r result$statistic`

## Find the P value
The p-valuse is
`r result$p.value`

## Decide to accept or reject the null hypothesis
```{r}
reject = (result$p.value < alpha)
if (! reject) {
  prefix="in"
} else {
  prefix=""
}
```
There is `r prefix`sufficient evidence (p-value `r result$p.value`, `r dof` degrees of freedom) to reject the null hypothesis that the mean age is `r null_mean`

## Conclusion
A `r 100*(1-alpha)`% confidence interval for the mean age of patrons is from
`r result$conf.int[1]`
to
`r result$conf.int[2]`
